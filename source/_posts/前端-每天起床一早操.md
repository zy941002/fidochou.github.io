---
layout: post
title: TypeScript æ¯å¤©èµ·åºŠä¸€æ—©æ“
date: 2022-*03*-28 08:10:10
tags: TypeScript
---

æ¯å¤©èµ·åºŠç»ƒä½“æ“ï¼Œç†è®º + å®è·µ åŠ©åŠ›å°å­¦ç”ŸèŒå£®æˆé•¿ï¼TypeScript å°å­¦ç”Ÿçš„è¿›å‡»ä¹‹è·¯ï¼š
<!-- more -->
* [TypeScript å¹¿åœº](https://www.typescriptlang.org/zh/play)
* [1.2Wå­— | äº†ä¸èµ·çš„ TypeScript å…¥é—¨æ•™ç¨‹](https://juejin.cn/post/6844904182843965453)
* [ä¸€æ–‡è¯»æ‡‚ TypeScript æ³›å‹åŠåº”ç”¨](https://juejin.cn/post/6844904184894980104)
* [æ·±å…¥ç†è§£ TypeScript](https://jkchao.github.io/typescript-book-chinese/#why)
* [è¿™ 30 é“ TS ç»ƒä¹ é¢˜ï¼Œä½ èƒ½ç­”å¯¹å‡ é“ï¼Ÿ](https://juejin.cn/post/7009046640308781063)
* [7 Powerful TypeScript Tools](https://javascript.plainenglish.io/powerful-typescript-tools-e1c7875fbb71)

# Q1. æ³›å‹ + ä½¿ç”¨çš„å‚è€ƒæ ‡å‡†ï¼Ÿ
1. å½“ä½ çš„ã€Œå‡½æ•°ã€ã€ã€Œæ¥å£ã€ã€ã€Œç±»ã€å°†å¤„ç†å¤šç§<font color="red">æ•°æ®ç±»å‹</font>æ—¶ï¼›
2. å½“ã€Œå‡½æ•°ã€ã€ã€Œæ¥å£ã€ã€ã€Œç±»ã€åœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨è¯¥æ•°æ®ç±»å‹æ—¶ã€‚

# Q2. ä»€ä¹ˆå«æ³›å‹<font color="red">çº¦æŸ</font>
æˆ‘ä»¬å¯èƒ½é™åˆ¶ã€Œæ¯ä¸ª<font color="red">ç±»å‹å˜é‡</font>æ¥å—çš„<font color="red">ç±»å‹æ•°é‡</font>ã€ï¼Œè¿™å°±æ˜¯æ³›å‹çº¦æŸçš„ä½œç”¨ã€‚

##  2.1 ç¡®ä¿å±æ€§å­˜åœ¨
æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯è®©ã€Œç±»å‹å˜é‡ã€ `extends` ä¸€ä¸ªå«æœ‰æˆ‘ä»¬æ‰€éœ€å±æ€§çš„æ¥å£(å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Ÿä¸ºä»€ä¹ˆæ˜¯æ¥å£å‘¢ï¼Ÿtype è¡Œä¸è¡Œ....)

ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä»€ä¹ˆæ—¶å€™ç»§æ‰¿ interfaceï¼Œä»€ä¹ˆæ—¶å€™ç»§æ‰¿ type å‘¢ï¼Ÿ

ä½¿ç”¨é€—å·æ¥å®ç°å¤šä¸ªç»§æ‰¿ï¼š`<T extends Length, Type2, Type3>`
<details>
  <summary>åˆ‡æ¢ &#8681;</summary>

```TypeScript
interface Length {
  length: number
}

function identity<T extends Length>(arg: T): T {
  console.log(arg.length) // å¯ä»¥è·å–lengthå±æ€§
  return arg
}
```
</details>


## 2.2 æ£€æŸ¥å¯¹è±¡ä¸Šçš„é”®æ˜¯å¦å­˜åœ¨
TypeScript 2.1  ç‰ˆæœ¬å¼•å…¥äº† [`keyof`](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-9.html#support-number-and-symbol-named-properties-with-keyof-and-mapped-types) æ“ä½œç¬¦ï¼Œè¯¥æ“ä½œç¬¦å¯ä»¥ç”¨äºè·å–æŸç§ç±»å‹çš„ã€Œæ‰€æœ‰é”®ã€ï¼Œå…¶è¿”å›ç±»å‹æ˜¯ã€Œè”åˆç±»å‹ã€

<details>
  <summary>åˆ‡æ¢ &#8681;</summary>

```TypeScript
interface Person {
  name: string
  age: number
  location: string
}

type K1 = keyof Person // "name" | "age" | "location"
type K2 = keyof Person[]  // number | "length" | "push" | "concat" | ...
type K3 = keyof { [x: string]: Person }  // string | number
console.log(K1)
'K1' only refers to a type, but is being used as a value here.
console.log(Person)

'Person' only refers to a type, but is being used as a value here.
è¯´æ˜ç±»å‹æ˜¯ä¸èƒ½ä½œä¸ºå€¼æ‰“å°å‡ºæ¥
```

```TypeScript
enum Difficulty {
  Easy,
  Intermediate,
  Hard
}

function getProperty<T, K extends keyof T>(obj: T, key: K): T[K] {
  return obj[key]
}

let tsInfo = {
  name: "Typescript",
  supersetOf: "Javascript",
  difficulty: Difficulty.Intermediate
}

let difficulty: Difficulty =
  getProperty(tsInfo, 'difficulty') // OK

let supersetOf: string =
  getProperty(tsInfo, 'superset_of') // Error
```
</details>


# Q3ï¼šæ³›å‹é»˜è®¤ç±»å‹

```TypeScript
interface A<T = string> {
  name: T
}

const strA: A = { name: "Semlinker" }
const numB: A<number> = { name: 101 }
// è¦é»˜è®¤å‚æ•°å¹²å•¥...
```

# Q4ï¼šæ³›å‹æ¡ä»¶ç±»å‹
```
  T extends U ? X : Y
```

ä»¥ä¸Šè¡¨è¾¾å¼çš„æ„æ€æ˜¯ï¼šè‹¥ T èƒ½å¤Ÿèµ‹å€¼ç»™ Uï¼Œé‚£ä¹ˆç±»å‹æ˜¯ Xï¼Œå¦åˆ™ä¸º Yã€‚åœ¨æ¡ä»¶ç±»å‹è¡¨è¾¾å¼ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è¿˜ä¼šç»“åˆ infer å…³é”®å­—ï¼Œå®ç°ç±»å‹æŠ½å–ï¼š

```TypeScript
interface Dictionary<T = any> {
  [key: string]: T
}

type StrDict = Dictionary<string>

type DictMember<T> = T extends Dictionary<infer V> ? V : never
type StrDictMember = DictMember<StrDict> // string
```

# Q5ï¼šæ³›å‹å·¥å…·
ä¸ºäº†æ–¹ä¾¿å¼€å‘è€… TypeScript å†…ç½®äº†ä¸€äº›å¸¸ç”¨çš„å·¥å…·ç±»å‹ï¼Œæ¯”å¦‚ Partialã€Requiredã€Readonlyã€Record å’Œ ReturnType ç­‰ã€‚

## 5.1 Partial
Partial<T> çš„ä½œç”¨å°±æ˜¯å°†æŸä¸ªç±»å‹é‡Œçš„å±æ€§å…¨éƒ¨å˜ä¸ºå¯é€‰é¡¹ ?ã€‚

## 5.2 Record
<details>
  <summary>åˆ‡æ¢ &#8681;</summary>

```TypeScript
interface PageInfo {
  title: string
}
type Page = 'Home' | 'About' | 'Contact'
const x: Record<Page, PageInfo> = {
  about: {
    title: 'ahout'
  },
  concact: {
    title: 'concact'
  },
  home: {
    title: 'homeÃŸ'
  }
}
// 1. æå–é€šç”¨çš„ property å‡ºæ¥ï¼Œè¿™é‡Œæ˜¯ title
// 2. ä¿è¯ key å€¼ï¼Œè¿™é‡Œæ˜¯ Page
```
</details>

## 5.3 Pick

å°†æŸä¸ªç±»å‹ä¸­çš„å­å±æ€§æŒ‘å‡ºæ¥ï¼Œå˜æˆåŒ…å«è¿™ä¸ªç±»å‹éƒ¨åˆ†å±æ€§çš„å­ç±»å‹ã€‚

<details>
  <summary>åˆ‡æ¢ &#8681;</summary>

```TypeScript
interface Todo {
  title: string
  description: string
  completed: boolean
}

type what = "title" | "completed"

type TodoPreview = Pick<Todo, what>

const todo: TodoPreview = {
  title: "Clean room",
  completed: false
};
```
</details>

## 5.4 Exclude

å°†æŸä¸ªç±»å‹ä¸­å±äºå¦ä¸€ä¸ªçš„ç±»å‹ç§»é™¤æ‰
<details>
  <summary>åˆ‡æ¢ &#8681;</summary>

```TypeScript
type T0 = Exclude<"a" | "b" | "c", "a"> // "b" | "c"
type T1 = Exclude<"a" | "b" | "c", "a" | "b"> // "c"
type T2 = Exclude<string | number | (() => void), Function> // string | number
```
</details>

## 5.5 ReturnType

è·å–å‡½æ•° T çš„è¿”å›ç±»å‹

# Q6. ä½¿ç”¨æ³›å‹åˆ›å»ºå¯¹è±¡

## 6.1 æ„é€ ç­¾å

åœ¨ TypeScript æ¥å£ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ new å…³é”®å­—æ¥æè¿°ä¸€ä¸ªæ„é€ å‡½æ•°ï¼š

<details>
  <summary>åˆ‡æ¢ &#8681;</summary>

```TypeScript
class FirstClass {
  id: number | undefined
}

class SecondClass {
  name: string | undefined;
}

class GenericCreator<T> {
  create(): T {
    return new T()
  }
}

const creator1 = new GenericCreator<FirstClass>()
const firstClass: FirstClass = creator1.create()

const creator2 = new GenericCreator<SecondClass>()
const secondClass: SecondClass = creator2.create()

// æŠ›é”™ï¼š'T' only refers to a type, but is being used as a value here.
// T åªæ˜¯ä»£è¡¨ä¸€ç§ç±»å‹ï¼Œä½†å´ä½œä¸ºå€¼ä½¿ç”¨
```
</details>

åœ¨ TypeScript æ¥å£ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ <font color="red">new </font>å…³é”®å­—æ¥æè¿°ä¸€ä¸ªæ„é€ å‡½æ•°ï¼š

```TypeScript
interface Point {
  new (x: number, y: number): Point
}
```

ä»¥ä¸Šæ¥å£ä¸­çš„ new (x: number, y: number) æˆ‘ä»¬ç§°ä¹‹ä¸ºã€Œæ„é€ ç­¾åã€ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š

```
ConstructSignature: â€ƒnewâ€ƒTypeParametersoptâ€ƒ(â€ƒParameterListopt)â€ƒTypeAnnotationopt
```

åœ¨ä¸Šè¿°çš„æ„é€ ç­¾åä¸­ï¼ŒTypeParametersopt ã€ParameterListopt å’Œ TypeAnnotationopt åˆ†åˆ«è¡¨ç¤ºï¼šå¯é€‰çš„ç±»å‹å‚æ•°ã€å¯é€‰çš„å‚æ•°åˆ—è¡¨å’Œå¯é€‰çš„ç±»å‹æ³¨è§£ã€‚ä¸è¯¥è¯­æ³•ç›¸å¯¹åº”çš„å‡ ç§å¸¸è§çš„ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š

```
new C   // å¯é€‰çš„ç±»å‹å‚æ•°
new C ( ... )   // å¯é€‰çš„å‚æ•°åˆ—è¡¨
new C < ... > ( ... ) // å¯é€‰çš„ç±»å‹æ³¨è§£
```
## 6.1 æ„é€ å‡½æ•°ç±»å‹

1. åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª<font color="red">æ„é€ ç­¾å</font>çš„å¯¹è±¡ç±»å‹è¢«ç§°ä¸ºæ„é€ å‡½æ•°ç±»å‹ï¼›
2. æ„é€ å‡½æ•°ç±»å‹å¯ä»¥ä½¿ç”¨<font color="red">ã€Œæ„é€ å‡½æ•°ç±»å‹å­—é¢é‡ã€</font>æˆ–åŒ…å«<font color="red">ã€Œæ„é€ ç­¾åã€</font>çš„å¯¹è±¡ç±»å‹å­—é¢é‡æ¥ç¼–å†™ã€‚

æ„é€ å‡½æ•°ç±»å‹å­—é¢é‡ ğŸ‘‡ï¼š
```js
new < T1, T2, ... > ( p1, p2, ... ) => R
```

ä¸ã€Œå¯¹è±¡ç±»å‹å­—é¢é‡ã€æ˜¯ç­‰ä»·çš„ï¼š

```js
{ new < T1, T2, ... > ( p1, p2, ... ) : R }
```

ä¸¾ä¸ªå®é™…çš„ç¤ºä¾‹ï¼š

```js
// ã€Œæ„é€ å‡½æ•°ç±»å‹å­—é¢é‡ã€
new (x: number, y: number) => Point
```

ç­‰ä»·äºï¼šã€Œå¯¹è±¡ç±»å‹å­—é¢é‡ã€
```
{ new (x: number, y: number): Point }
```

## 6.2 æ„é€ å‡½æ•°ç±»å‹çš„åº”ç”¨
<details>
  <summary>åˆ‡æ¢ &#8681;</summary>

```TypeScript
interface Point {
  new (x: number, y: number): Point
  x: number
  y: number
}

class Point2D implements Point {
  readonly x: number
  readonly y: number

  constructor(x: number, y: number) {
    this.x = x
    this.y = y
  }
}

const point: Point = new Point2D(1, 2)
// æŠ›é”™ï¼š
// Class 'Point2D' incorrectly implements interface 'Point'.
// Type 'Point2D' provides no match for the signature 'new (x: number, y: number): Point'.

```
</details>

è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠå¯¹å‰é¢å®šä¹‰çš„ Point æ¥å£è¿›è¡Œåˆ†ç¦»ï¼Œå³æŠŠæ¥å£çš„å±æ€§å’Œæ„é€ å‡½æ•°ç±»å‹è¿›è¡Œåˆ†ç¦»ï¼š

```TypeScript
interface Point {
  x: number;
  y: number;
}

interface PointConstructor {
  new (x: number, y: number): Point;
}
```

å®Œæˆæ¥å£æ‹†åˆ†ä¹‹åï¼Œé™¤äº†å‰é¢å·²ç»å®šä¹‰çš„ Point2D ç±»ä¹‹å¤–ï¼Œæˆ‘ä»¬åˆå®šä¹‰äº†ä¸€ä¸ª newPoint å·¥å‚å‡½æ•°ï¼Œè¯¥å‡½æ•°ç”¨äºæ ¹æ®ä¼ å…¥çš„ PointConstructor ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œæ¥åˆ›å»ºå¯¹åº”çš„ Point å¯¹è±¡ã€‚

<details>
  <summary>åˆ‡æ¢ &#8681;</summary>

```TypeScript
class Point2D implements Point {
  readonly x: number
  readonly y: number;

  constructor(x: number, y: number) {
    this.x = x;
    this.y = y;
  }
}

function newPoint(
  pointConstructor: PointConstructor,
  x: number,
  y: number
): Point {
  return new pointConstructor(x, y);
}

const point: Point = newPoint(Point2D, 1, 2)
```
</details>

## 6.3 ä½¿ç”¨æ³›å‹åˆ›å»ºå¯¹è±¡

```TypeScript
class GenericCreator<T> {
  create<T>(c: { new (): T }): T {
    return new c();
  }
}
```

åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬é‡æ–°å®šä¹‰äº† create æˆå‘˜æ–¹æ³•ï¼Œæ ¹æ®è¯¥æ–¹æ³•çš„ç­¾åï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå…¶ç±»å‹æ˜¯æ„é€ å‡½æ•°ç±»å‹ï¼Œä¸”è¯¥æ„é€ å‡½æ•°ä¸åŒ…å«ä»»ä½•å‚æ•°ï¼Œè°ƒç”¨è¯¥æ„é€ å‡½æ•°åï¼Œä¼šè¿”å›ç±»å‹ T çš„å®ä¾‹ã€‚

å¦‚æœæ„é€ å‡½æ•°å«æœ‰å‚æ•°çš„è¯ï¼Œæ¯”å¦‚åŒ…å«ä¸€ä¸ª number ç±»å‹çš„å‚æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ create æ–¹æ³•ï¼š

create<T>(c: { new(a: number): T; }, num: number): T {
  return new c(num);
}

æ›´æ–°å®Œ GenericCreator æ³›å‹ç±»ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼æ¥åˆ›å»º FirstClass å’Œ SecondClass ç±»çš„å®ä¾‹:

```TypeScript
const creator1 = new GenericCreator<FirstClass>();
const firstClass: FirstClass = creator1.create(FirstClass);

const creator2 = new GenericCreator<SecondClass>();
const secondClass: SecondClass = creator2.create(SecondClass);

```